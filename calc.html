<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YMC æ³¨å¡‘ç²¾å¯†æ’ç¨‹ç³»ç»Ÿ</title>
    <style>
        :root { --primary: #0284c7; --bg: #f8fafc; --card: #ffffff; --border: #e2e8f0; --text: #334155; --logo-color: #0f172a; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: var(--text); padding: 20px; max-width: 800px; margin: 0 auto; padding-bottom: 120px; }
        
        /* é¡¶éƒ¨å“ç‰Œæ  */
        .header { display: flex; align-items: center; justify-content: center; margin-bottom: 25px; padding-bottom: 20px; border-bottom: 2px solid #e2e8f0; }
        
        /* Logo æ ·å¼ (å¦‚æœæ²¡æœ‰å›¾ç‰‡ï¼Œè¿™æ®µCSSä¼šç”»ä¸€ä¸ªæ¤­åœ†YMC) */
        .logo-css {
            border: 3px solid var(--logo-color);
            border-radius: 50%; /* æ¤­åœ†æ•ˆæœ */
            padding: 2px 12px;
            font-weight: 900;
            font-size: 20px;
            color: var(--logo-color);
            letter-spacing: 1px;
            margin-right: 15px;
            font-style: italic;
            display: inline-block;
            white-space: nowrap;
        }

        /* å¦‚æœä½ æœ‰çœŸå®çš„å›¾ç‰‡ï¼Œç”¨è¿™ä¸ªæ ·å¼ */
        .logo-img { height: 40px; margin-right: 15px; display: none; /* é»˜è®¤éšè—ï¼Œæœ‰å›¾æ—¶å»æ‰è¿™è¡Œ */ }

        .app-title { font-size: 22px; font-weight: bold; color: #1e293b; letter-spacing: 0.5px; }

        /* å¡ç‰‡å®¹å™¨ */
        .card { background: var(--card); border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); margin-bottom: 20px; border: 1px solid var(--border); }
        h3 { font-size: 15px; color: #64748b; margin-top: 0; margin-bottom: 15px; text-transform: uppercase; border-left: 4px solid var(--primary); padding-left: 10px; }

        /* è¾“å…¥æ¡†æ ·å¼ */
        .input-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .input-row label { font-size: 15px; font-weight: 500; }
        .input-wrapper { width: 120px; position: relative; }
        input[type="number"] { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 16px; text-align: right; font-weight: bold; color: var(--primary); outline: none; transition: border 0.2s; }
        input[type="number"]:focus { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(2, 132, 199, 0.1); }
        .unit { position: absolute; right: 30px; top: 9px; font-size: 12px; color: #94a3b8; pointer-events: none; }
        
        /* å¼€å…³ç»„ä»¶ */
        .toggle-row { display: flex; align-items: center; justify-content: space-between; padding: 12px; background: #f8fafc; border-radius: 8px; margin-bottom: 10px; border: 1px solid transparent; transition: all 0.2s; }
        .toggle-row.active { border-color: var(--primary); background: #f0f9ff; }
        
        .toggle-left { display: flex; align-items: center; gap: 10px; flex: 1; cursor: pointer; }
        .toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; pointer-events: none; } /* ç¦ç”¨å¼€å…³æœ¬èº«çš„ç‚¹å‡»ï¼Œæ”¹ä¸ºç‚¹å‡»æ•´è¡Œ */
        .slider { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: #cbd5e1; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(20px); }

        .toggle-input { width: 100px; display: none; animation: fadeIn 0.3s; }
        .active .toggle-input { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

        /* åº•éƒ¨ç»“æœæ  */
        .result-bar { background: #1e293b; color: white; padding: 20px; border-radius: 12px; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 760px; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5); z-index: 100; display: flex; flex-direction: column; }
        .result-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; text-align: center; }
        .res-item { display: flex; flex-direction: column; }
        .res-label { font-size: 11px; color: #94a3b8; margin-bottom: 4px; }
        .res-val { font-size: 20px; font-weight: bold; color: #38bdf8; }
        .res-val.bad { color: #f87171; }
        
        .hint-text { font-size: 10px; color: #64748b; text-align: center; margin-top: 10px; opacity: 0.8; }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo-css" id="cssLogo">YMC</div>
        
        <img src="logo.png" class="logo-img" id="imgLogo" alt="YMC Logo" onerror="this.style.display='none'; document.getElementById('cssLogo').style.display='inline-block';">
        
        <div class="app-title">æ³¨å¡‘æ™ºèƒ½æ’ç¨‹ç³»ç»Ÿ V3.1</div>
    </div>

    <div class="card">
        <h3>1. åŸºç¡€ç”Ÿäº§æ•°æ® (Base)</h3>
        <div class="input-row">
            <label>ğŸ“… è®¡åˆ’æ’ç­æ—¶é•¿</label>
            <div class="input-wrapper"><input type="number" id="baseHours" value="22" oninput="calc()"><span class="unit" style="right:10px">å°æ—¶</span></div>
        </div>
        <div class="input-row">
            <label>ğŸ“¦ è®¢å•è‰¯å“æ€»æ•°</label>
            <div class="input-wrapper"><input type="number" id="orderQty" value="50000" oninput="calc()"></div>
        </div>
        <div class="input-row">
            <label>â±ï¸ æ ‡å‡†æˆå‹å‘¨æœŸ</label>
            <div class="input-wrapper"><input type="number" id="cycle" value="40.5" step="0.1" oninput="calc()"><span class="unit" style="right:10px">ç§’</span></div>
        </div>
        <div class="input-row">
            <label>âš™ï¸ æ¨¡å…·ç©´æ•°</label>
            <div class="input-wrapper"><input type="number" id="cavity" value="4" oninput="calc()"></div>
        </div>
    </div>

    <div class="card" style="margin-bottom: 150px;"> <h3>2. ç²¾ç¡®è€—æŸå› ç´  (ç‚¹å‡»å¼€å¯)</h3>

        <div class="toggle-row" id="row-mold" onclick="toggleRow('mold')">
            <div class="toggle-left">
                <label class="toggle-switch"><input type="checkbox" id="check-mold"><span class="slider"></span></label>
                <span>ğŸ› ï¸ æ¢æ¨¡/ä¿®æ¨¡æ—¶é—´</span>
            </div>
            <div class="toggle-input" onclick="event.stopPropagation()">
                <input type="number" id="val-mold" placeholder="åˆ†é’Ÿ" value="28" oninput="calc()">
            </div>
        </div>

        <div class="toggle-row" id="row-warm" onclick="toggleRow('warm')">
            <div class="toggle-left">
                <label class="toggle-switch"><input type="checkbox" id="check-warm"><span class="slider"></span></label>
                <span>ğŸ”¥ æš–æœº/å°„å˜´æ¸…ç†</span>
            </div>
            <div class="toggle-input" onclick="event.stopPropagation()">
                <input type="number" id="val-warm" placeholder="åˆ†é’Ÿ" value="15" oninput="calc()">
            </div>
        </div>

        <div class="toggle-row" id="row-break" onclick="toggleRow('break')">
            <div class="toggle-left">
                <label class="toggle-switch"><input type="checkbox" id="check-break"><span class="slider"></span></label>
                <span>ğŸ± åƒé¥­/æ¢ç­åœæœº</span>
            </div>
            <div class="toggle-input" onclick="event.stopPropagation()">
                <input type="number" id="val-break" placeholder="åˆ†é’Ÿ" value="60" oninput="calc()">
            </div>
        </div>

        <div class="toggle-row" id="row-qc" onclick="toggleRow('qc')">
            <div class="toggle-left">
                <label class="toggle-switch"><input type="checkbox" id="check-qc"><span class="slider"></span></label>
                <span>ğŸ” é¦–ä»¶/å·¡æ£€åœæœº</span>
            </div>
            <div class="toggle-input" onclick="event.stopPropagation()">
                <input type="number" id="val-qc" placeholder="åˆ†é’Ÿ" value="10" oninput="calc()">
            </div>
        </div>

        <div class="toggle-row" id="row-scrap" onclick="toggleRow('scrap')" style="border-left: 3px solid #f59e0b;">
            <div class="toggle-left">
                <label class="toggle-switch"><input type="checkbox" id="check-scrap"><span class="slider"></span></label>
                <span>âš ï¸ é¢„è®¡ä¸è‰¯/æŸè€—ç‡ (%)</span>
            </div>
            <div class="toggle-input" onclick="event.stopPropagation()">
                <input type="number" id="val-scrap" placeholder="%" value="2.5" step="0.1" oninput="calc()">
            </div>
        </div>
    </div>

    <div class="result-bar">
        <div class="result-grid">
            <div class="res-item">
                <span class="res-label">å®Œæˆè®¢å•éœ€</span>
                <span class="res-val" id="daysNeeded">0.0 å¤©</span>
            </div>
            <div class="res-item">
                <span class="res-label">ä»Šæ—¥å®é™…äº§èƒ½</span>
                <span class="res-val" id="dailyOutput">0</span>
            </div>
            <div class="res-item">
                <span class="res-label">å¿…é¡»æŠ•æ–™æ€»æ•°</span>
                <span class="res-val bad" id="totalFeed">0</span>
            </div>
        </div>
        <div class="hint-text" id="timeHint">å·²æ‰£é™¤ 0 åˆ†é’Ÿåœæœºæ—¶é—´ | å‡€ç”Ÿäº§æ—¶é—´ 0 å°æ—¶</div>
    </div>

    <script>
        // æ£€æµ‹æ˜¯å¦æœ‰å›¾ç‰‡ï¼Œå¦‚æœæœ‰å°±æ˜¾ç¤ºå›¾ç‰‡ï¼Œæ²¡æœ‰å°±æ˜¾ç¤ºCSSç”»çš„
        window.onload = function() {
            var img = document.getElementById('imgLogo');
            var css = document.getElementById('cssLogo');
            img.onload = function() {
                img.style.display = 'block';
                css.style.display = 'none';
            };
            img.onerror = function() {
                img.style.display = 'none';
                css.style.display = 'inline-block';
            };
        };

        function toggleRow(id) {
            const checkbox = document.getElementById('check-' + id);
            checkbox.checked = !checkbox.checked; // åˆ‡æ¢å‹¾é€‰çŠ¶æ€
            
            const row = document.getElementById('row-' + id);
            if (checkbox.checked) {
                row.classList.add('active');
            } else {
                row.classList.remove('active');
            }
            calc();
        }

        function calc() {
            let baseHours = Number(document.getElementById('baseHours').value) || 0;
            let orderQty = Number(document.getElementById('orderQty').value) || 0;
            let cycle = Number(document.getElementById('cycle').value) || 0;
            let cavity = Number(document.getElementById('cavity').value) || 0;

            if (cycle === 0 || cavity === 0) return;

            let totalLossMinutes = 0;

            // ç´¯è®¡æ‰€æœ‰å‹¾é€‰çš„æ—¶é—´æŸè€—
            if (document.getElementById('check-mold').checked) totalLossMinutes += Number(document.getElementById('val-mold').value);
            if (document.getElementById('check-warm').checked) totalLossMinutes += Number(document.getElementById('val-warm').value);
            if (document.getElementById('check-break').checked) totalLossMinutes += Number(document.getElementById('val-break').value);
            if (document.getElementById('check-qc').checked) totalLossMinutes += Number(document.getElementById('val-qc').value);

            // å‡€æ—¶é—´
            let totalSecondsAvailable = (baseHours * 60 - totalLossMinutes) * 60;
            if (totalSecondsAvailable < 0) totalSecondsAvailable = 0;

            // éœ€æ±‚é‡è®¡ç®—
            let finalTargetQty = orderQty;
            if (document.getElementById('check-scrap').checked) {
                let scrapRate = Number(document.getElementById('val-scrap').value) / 100;
                if (scrapRate < 1) finalTargetQty = Math.ceil(orderQty / (1 - scrapRate));
            }

            // äº§èƒ½è®¡ç®—
            let dailyOutput = Math.floor((totalSecondsAvailable / cycle) * cavity);
            let days = 0;
            if (dailyOutput > 0) days = (finalTargetQty / dailyOutput).toFixed(2);

            // æ›´æ–°æ˜¾ç¤º
            let netHours = (totalSecondsAvailable / 3600).toFixed(1);
            
            document.getElementById('daysNeeded').innerText = days + " å¤©";
            document.getElementById('dailyOutput').innerText = dailyOutput.toLocaleString();
            document.getElementById('totalFeed').innerText = finalTargetQty.toLocaleString();
            document.getElementById('timeHint').innerText = `å·²æ‰£é™¤ ${totalLossMinutes} åˆ†é’Ÿåœæœº | å‡€ç”Ÿäº§æ—¶é—´ ${netHours} å°æ—¶`;
        }

        // åˆå§‹åŒ–
        calc();
    </script>
</body>
</html>